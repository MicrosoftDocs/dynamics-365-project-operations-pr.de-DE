---
title: Automatische Rechnungserstellung einrichten
description: Dieses Thema enthält Informationen zum Einrichten und Konfigurieren der automatischen Erstellung von Proforma-Rechnungen.
author: rumant
ms.date: 04/05/2021
ms.topic: article
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 2d212f2279b28d900e75d45386e343f95b8e825e
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004170"
---
# <a name="set-up-automatic-invoice-creation"></a><span data-ttu-id="00575-103">Automatische Rechnungserstellung einrichten</span><span class="sxs-lookup"><span data-stu-id="00575-103">Set up automatic invoice creation</span></span> 
 
<span data-ttu-id="00575-104">_**Gilt für:** Lite-Bereitstellung – Abschluss zur Proforma-Rechnungsstellung Project Operations für Ressourcen/nicht vorrätige Szenarien_</span><span class="sxs-lookup"><span data-stu-id="00575-104">_**Applies To:** Lite deployment - deal to proforma invoicing, Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="00575-105">In Dynamics 365 Project Operations können Sie die automatische Rechnungserstellung konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="00575-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="00575-106">Das System erstellt einen Entwurf einer Proforma-Rechnung basierend auf dem Rechnungsplan für jeden Projektvertrag und jede Vertragszeile.</span><span class="sxs-lookup"><span data-stu-id="00575-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="00575-107">Rechnungspläne werden auf Vertragszeilenebene konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="00575-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="00575-108">Jede Zeile in einem Vertrag kann einen eigenen Rechnungsplan haben, oder in jeder Zeile des Vertrags kann derselbe Rechnungsplan enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="00575-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="00575-109">Wenn Sie eine Rechnung erstellen, erstellt das System immer mindestens eine Rechnung pro Projektvertrag.</span><span class="sxs-lookup"><span data-stu-id="00575-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="00575-110">In einigen Fällen werden möglicherweise mehrere Rechnungen erstellt.</span><span class="sxs-lookup"><span data-stu-id="00575-110">In some cases, there may be multiple invoices created.</span></span> <span data-ttu-id="00575-111">Wenn der Vertrag beispielsweise mehrere Kunden hat, wird dieselbe Anzahl von Rechnungen erstellt wie die Anzahl der Kunden, die fakturierbare Transaktionen für diesen Projektvertrag in Rechnung stellen müssen.</span><span class="sxs-lookup"><span data-stu-id="00575-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="00575-112">Informationen dazu, wie Transaktionen in einer Rechnung eingeschlossen sind</span><span class="sxs-lookup"><span data-stu-id="00575-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="00575-113">Manchmal gibt jede projektbasierte Vertragszeile einen separaten Rechnungszeitplan an.</span><span class="sxs-lookup"><span data-stu-id="00575-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="00575-114">Implementierungsservices für den Adatum-Vertrag haben beispielsweise die folgenden Vertragszeilen:</span><span class="sxs-lookup"><span data-stu-id="00575-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="00575-115">Prototyparbeit zum Festpreis mit zwei manuell erstellten Meilensteinen</span><span class="sxs-lookup"><span data-stu-id="00575-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="00575-116">Implementierungsarbeiten, die Zeit beinhalten und montags vierzehntägig in Rechnung gestellt werden</span><span class="sxs-lookup"><span data-stu-id="00575-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="00575-117">Anfallende Kosten, die monatlich am ersten Montag eines jeden Monats in Rechnung gestellt werden müssen</span><span class="sxs-lookup"><span data-stu-id="00575-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="00575-118">Die für jede dieser beiden Positionen definierten Rechnungszeitpläne sehen wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="00575-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="00575-119">Vertragszeile</span><span class="sxs-lookup"><span data-stu-id="00575-119">Contract line</span></span> | <span data-ttu-id="00575-120">Rechnungsdurchlaufdatum</span><span class="sxs-lookup"><span data-stu-id="00575-120">Invoice run date</span></span> | <span data-ttu-id="00575-121">Transaktionsabschnittsdatum</span><span class="sxs-lookup"><span data-stu-id="00575-121">Transaction cut-off date</span></span> | <span data-ttu-id="00575-122">Meilensteindatum</span><span class="sxs-lookup"><span data-stu-id="00575-122">Milestone date</span></span> | <span data-ttu-id="00575-123">Meilenstein-Betrag</span><span class="sxs-lookup"><span data-stu-id="00575-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="00575-124">Prototyparbeit</span><span class="sxs-lookup"><span data-stu-id="00575-124">Prototype work</span></span> | <span data-ttu-id="00575-125">Montag, 5. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-125">October 5, Monday</span></span> | - | <span data-ttu-id="00575-126">Montag, 5. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-126">October 5, Monday</span></span> | <span data-ttu-id="00575-127">5.000 USD</span><span class="sxs-lookup"><span data-stu-id="00575-127">5000 USD</span></span> |
| - | <span data-ttu-id="00575-128">Dienstag, 3. November</span><span class="sxs-lookup"><span data-stu-id="00575-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="00575-129">Dienstag, 3. November</span><span class="sxs-lookup"><span data-stu-id="00575-129">November 3, Tuesday</span></span> | <span data-ttu-id="00575-130">12.000 USD</span><span class="sxs-lookup"><span data-stu-id="00575-130">12,000 USD</span></span> |
| <span data-ttu-id="00575-131">Implementierungsarbeit</span><span class="sxs-lookup"><span data-stu-id="00575-131">Implementation work</span></span> | <span data-ttu-id="00575-132">Montag, 5. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-132">October 5, Monday</span></span> | <span data-ttu-id="00575-133">Sonntag, 4. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="00575-134">Montag, 19. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-134">October 19, Monday</span></span> | <span data-ttu-id="00575-135">Sonntag, 18. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="00575-136">Montag, 2. November</span><span class="sxs-lookup"><span data-stu-id="00575-136">November 2, Monday</span></span> | <span data-ttu-id="00575-137">Sonntag, 1. November</span><span class="sxs-lookup"><span data-stu-id="00575-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="00575-138">Montag, 16. November</span><span class="sxs-lookup"><span data-stu-id="00575-138">November 16, Monday</span></span> | <span data-ttu-id="00575-139">Sonntag, 15. November</span><span class="sxs-lookup"><span data-stu-id="00575-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="00575-140">Angefallene Kosten</span><span class="sxs-lookup"><span data-stu-id="00575-140">Expenses incurred</span></span> | <span data-ttu-id="00575-141">Montag, 5. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-141">October 5, Monday</span></span> | <span data-ttu-id="00575-142">Sonntag, 4. Oktober</span><span class="sxs-lookup"><span data-stu-id="00575-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="00575-143">Montag, 2. November</span><span class="sxs-lookup"><span data-stu-id="00575-143">November 2, Monday</span></span> | <span data-ttu-id="00575-144">Sonntag, 1. November</span><span class="sxs-lookup"><span data-stu-id="00575-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="00575-145">Bei Ausführung der automatischen Rechnungsstellung in diesem Beispiel am folgenden Datum:</span><span class="sxs-lookup"><span data-stu-id="00575-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="00575-146">**4. Oktober oder ein Datum davor**: Für diesen Vertrag wird keine Rechnung erstellt, da die Tabelle **Rechnungszeitplan** für jede dieser Vertragszeilen Sonntag, den 4. Oktober nicht als Datum des Rechnungslaufs angibt.</span><span class="sxs-lookup"><span data-stu-id="00575-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="00575-147">**Montag, 5. Oktober**: Eine Rechnung wird erstellt für:</span><span class="sxs-lookup"><span data-stu-id="00575-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="00575-148">Prototyparbeit, die den Meilenstein enthält, wenn er als **Bereit für die Rechnungsstellung** markiert ist</span><span class="sxs-lookup"><span data-stu-id="00575-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="00575-149">Implementierungsarbeiten, die alle Zeittransaktionen umfassen, die vor dem Transaktionsstichtag Sonntag, 4. Oktober erstellt und als **Bereit für die Rechnungsstellung** markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="00575-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="00575-150">Angefallene Kosten, die alle Ausgabentransaktionen umfassen, die vor dem Transaktionsstichtag Sonntag, 4. Oktober erstellt und als **Bereit für die Rechnungsstellung** markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="00575-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="00575-151">**Am 6. Oktober oder an einem Datum vor dem 19. Oktober**: Für diesen Vertrag wird keine Rechnung erstellt, da die Tabelle **Rechnungszeitplan** für jede dieser Vertragszeilen den 06. Oktober oder ein Datum vor dem 19. Oktober nicht als Datum des Rechnungslaufs angibt.</span><span class="sxs-lookup"><span data-stu-id="00575-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="00575-152">**Montag, 19. Oktober**: Eine Rechnung wird für Implementierungsarbeiten generiert, die alle Zeittransaktionen enthält, die vor dem Transaktionsstichtag Sonntag, 18. Oktober erstellt und als **Bereit für die Rechnungsstellung** markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="00575-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="00575-153">**Montag, 2. November**: Eine Rechnung wird erstellt für:</span><span class="sxs-lookup"><span data-stu-id="00575-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="00575-154">Implementierungsarbeiten, die alle Zeittransaktionen umfassen, die vor dem Transaktionsstichtag Sonntag, 1. November erstellt und als **Bereit für die Rechnungsstellung** markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="00575-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="00575-155">Angefallene Kosten, die alle Ausgabentransaktionen umfassen, die vor dem Transaktionsstichtag Sonntag, 1. November erstellt und als **Bereit für die Rechnungsstellung** markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="00575-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="00575-156">**Dienstag, 3. November**: Eine Rechnung wird für Prototyparbeit erstellt, die den Meilenstein für 12.000 USD enthält, sofern dieser als **Bereit für die Rechnungsstellung** markiert ist.</span><span class="sxs-lookup"><span data-stu-id="00575-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="00575-157">Automatische Rechnungsstellung konfigurieren</span><span class="sxs-lookup"><span data-stu-id="00575-157">Configure automatic invoicing</span></span>

<span data-ttu-id="00575-158">Führen Sie die folgenden Schritte aus, um einen automatisierten Rechnungslauf zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="00575-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="00575-159">Navigieren Sie in **Project Operations** zu **Einstellungen** > **Setup für wiederkehrende Rechnungen**.</span><span class="sxs-lookup"><span data-stu-id="00575-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="00575-160">Erstellen Sie einen Batchauftrag und nennen Sie ihn **Vorgang zum Erstellen von Rechnungen**.</span><span class="sxs-lookup"><span data-stu-id="00575-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="00575-161">Der Name des Batchauftrags muss die Wörter „Rechnungen erstellen“ enthalten.</span><span class="sxs-lookup"><span data-stu-id="00575-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="00575-162">Wählen Sie im Feld **Auftragstyp** **Keiner** aus.</span><span class="sxs-lookup"><span data-stu-id="00575-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="00575-163">Standardmäßig sind die Felder **Frequenz täglich** und **Ist aktiv** auf **Ja** festgelegt.</span><span class="sxs-lookup"><span data-stu-id="00575-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="00575-164">Wählen Sie **Workflow ausführen** aus.</span><span class="sxs-lookup"><span data-stu-id="00575-164">Select **Run Workflow**.</span></span> <span data-ttu-id="00575-165">Im Dialogfeld **Datensatz suchen** werden drei Workflows angezeigt:</span><span class="sxs-lookup"><span data-stu-id="00575-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="00575-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="00575-166">ProcessRunCaller</span></span>
- <span data-ttu-id="00575-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="00575-167">ProcessRunner</span></span>
- <span data-ttu-id="00575-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="00575-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="00575-169">Wählen Sie **ProcessRunCaller** und dann **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="00575-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="00575-170">Wählen Sie im nächsten Dialogfeld die Option **OK** aus.</span><span class="sxs-lookup"><span data-stu-id="00575-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="00575-171">Auf den Workflow **Ruhezustand** folgt der Workflow **Verarbeiten**.</span><span class="sxs-lookup"><span data-stu-id="00575-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="00575-172">Sie können auch **ProcessRunner** in Schritt 5 auswählen.</span><span class="sxs-lookup"><span data-stu-id="00575-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="00575-173">Wenn Sie dann **OK** auswählen, folgt auf einen **Process**-Workflow ein **Sleep**-Workflow.</span><span class="sxs-lookup"><span data-stu-id="00575-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="00575-174">Die Workflows **ProcessRunCaller** und **ProcessRunner** erstellen Rechnungen.</span><span class="sxs-lookup"><span data-stu-id="00575-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="00575-175">**ProcessRunCaller** ruft **ProcessRunner** auf.</span><span class="sxs-lookup"><span data-stu-id="00575-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="00575-176">**ProcessRunner** ist der Workflow, der die Rechnungen tatsächlich erstellt.</span><span class="sxs-lookup"><span data-stu-id="00575-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="00575-177">Der Workflow durchläuft alle Vertragszeilen, für die Rechnungen erstellt werden sollen, und erstellt Rechnungen für diese Zeilen.</span><span class="sxs-lookup"><span data-stu-id="00575-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="00575-178">Zur Bestimmung der Vertragszeilen, für die Rechnungen erstellt werden sollen, überprüft der Job die Rechnungsdurchlaufdaten für die Vertragszeilen.</span><span class="sxs-lookup"><span data-stu-id="00575-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="00575-179">Wenn Vertragszeilen, die zu einem Vertrag gehören, dasselbe Rechnungslaufdatum haben, werden die Transaktionen zu einer Rechnung mit zwei Rechnungszeilen zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="00575-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="00575-180">Wenn keine Transaktionen zum Erstellen von Rechnungen vorhanden sind, überspringt der Auftrag das Erstellen einer Rechnung.</span><span class="sxs-lookup"><span data-stu-id="00575-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="00575-181">Nachdem **ProcessRunner** ausgeführt wurde, ruft es **ProcessRunCaller** auf, gibt die Endzeit an und wird geschlossen.</span><span class="sxs-lookup"><span data-stu-id="00575-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="00575-182">**ProcessRunCaller** startet dann einen Zeitgeber, der ab der angegebenen Endzeit 24 Stunden lang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="00575-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="00575-183">Am Ende des Zeitgebers wird **ProcessRunCaller** geschlossen.</span><span class="sxs-lookup"><span data-stu-id="00575-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="00575-184">Der Batchverarbeitungsauftrag zum Erstellen von Rechnungen ist ein wiederkehrender Auftrag.</span><span class="sxs-lookup"><span data-stu-id="00575-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="00575-185">Wenn diese Batchverarbeitung mehrmals ausgeführt wird, werden mehrere Instanzen des Auftrags erstellt, und es werden Fehler verursacht.</span><span class="sxs-lookup"><span data-stu-id="00575-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="00575-186">Deshalb sollten Sie die Batchverarbeitung nur einmal starten und nur dann neu starten, wenn sie nicht mehr ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="00575-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="00575-187">Die Batchabrechnung wird nur für Projektvertragszeilen in Project Operations ausgeführt, die durch Rechnungszeitpläne konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="00575-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="00575-188">Für eine Vertragszeile mit einer Festpreis-Abrechnungsmethode müssen Meilensteine konfiguriert sein.</span><span class="sxs-lookup"><span data-stu-id="00575-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="00575-189">Für eine Projektvertragsposition mit einer Zeit- und Materialabrechnungsmethode muss ein datumsbasierter Rechnungszeitplan erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="00575-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
